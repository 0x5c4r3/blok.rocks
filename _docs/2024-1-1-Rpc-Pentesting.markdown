---
layout:     post
author:     0x5c4r3
type: docs
permalink: Rpc_Pentesting
---


<span style="font-size: 35px; color:red"><b>RPC Pentesting</b></span>

<span style="font-size: 25px; color:white"><b>Check Informations</b></span>

```shell
rpcclient -U '' <IP>
```

```shell
rpcclient -U '' -N <IP>
```
from here, you can enumerate:
		- <span style="color:red">enumdomusers</span>: users in the domain
		- <span style="color:red">queryuser</span> '0x...' : to get information about certain user.
		- <span style="color:red">queryusergroups</span> '0x...': groups of a user
		- <span style="color:red">querygroup</span> '0x...': info on a group
		- <span style="color:red">querydispinfo</span>: query a bunch of default useful fields (usually dump also password if lucky!)
&nbsp;

---
&nbsp;
<span style="font-size: 25px; color:white"><b>Change other user's password</b></span>
Once logged into RPC as user:
```shell
setuserinfo2 <username> 23 '<password>'
```
if works, does not return anything in output

&nbsp;

---
&nbsp;
<span style="font-size: 25px; color:white"><b>Check UUID mappings for RDP</b></span>
```shell
rpcmap.py -p <port> <IP>
```

You can bruteforce uuids with
```shell
rpcmap.py 'ncacn_ip_tcp:10.10.10.213' -brute-uuid -brute-opnums -auth-level 1 -opnum-max 5
```
and then google the UUIDS it's successful with. (i.e. there is an exploit that allows you to enumerate interfaces!)
